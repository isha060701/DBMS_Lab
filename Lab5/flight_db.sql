create database flight_db;
use flight_db;

CREATE TABLE FLIGHTS
(FLNO INTEGER PRIMARY KEY,
FFROM VARCHAR(15) NOT NULL,
TTO VARCHAR(15) NOT NULL,
DISTANCE INTEGER,
DEPARTS TIME,
ARRIVES TIME,
PRICE int);
DROP TABLE FLIGHTS;
CREATE TABLE AIRCRAFT
(AID INTEGER PRIMARY KEY,
ANAME VARCHAR(10),
CRUISINGRANGE INTEGER);

CREATE TABLE EMPLOYEES
(EID INTEGER PRIMARY KEY,
ENAME VARCHAR(15),
SALARY int);

CREATE TABLE CERTIFIED
(EID INTEGER NOT NULL,
AID INTEGER NOT NULL,
PRIMARY KEY (EID, AID),
FOREIGN KEY (EID) REFERENCES EMPLOYEES (EID),
FOREIGN KEY (AID) REFERENCES AIRCRAFT (AID));

insert into FLIGHTS
values (101,"Bangalore","Delhi",2500,"07:15:31","12:15:31",5000),
(102,"Bangalore","Lucknow",3000,"07:15:31","11:15:31",6000),
(103,"Lucknow","Delhi",500,"12:15:31","17:15:31",3000),
(107,"Bangalore","Frankfurt",8000,"07:15:31","22:15:31",60000),
(104,"Bangalore","Frankfurt",8500,"07:15:31","23:15:31",75000),
(105,"Kolkata","Delhi",3400,"07:15:31","09:15:31",7000);
insert into FLIGHTS
values (106,"Delhi","Kolkata",3400,"12:15:35","14:20:00",7000);

insert into AIRCRAFT
values (101,"747",3000),
(102,"Boeing",900),
(103,"647",800),
(104,"Dreamliner",10000),
(105,"Boeing",3500),
(106,"707",1500),
(107,"Dream",12000);

insert into EMPLOYEES
values (701,'A',50000),
(702,'B',100000),
(703,'C',150000),
(704,'D',90000),
(705,'E',40000),
(706,'F',60000),
(707,'G',90000);

insert into CERTIFIED
values 
(701,101),
(701,102),
(701,106),
(701,105),
(702,104),
(703,104),
(704,104),
(702,107),
(703,107),
(704,107),
(702,101),
(703,105),
(704,105),
(705,103);


SELECT DISTINCT A.ANAME
FROM AIRCRAFT A,CERTIFIED C,EMPLOYEES E
WHERE A.AID=C.AID AND C.EID=E.EID AND SALARY>80000;

SELECT C.EID,MAX(A.CRUISINGRANGE)
FROM CERTIFIED C,AIRCRAFT A
WHERE C.AID=A.AID
GROUP BY C.EID
HAVING COUNT(*)>3;

SELECT ENAME
FROM EMPLOYEES
WHERE SALARY <(SELECT MIN(PRICE)
FROM FLIGHTS
WHERE FFROM="Bangalore" AND TTO="Frankfurt");

SELECT A.ANAME,AVG(E.SALARY)
FROM CERTIFIED C,EMPLOYEES E,AIRCRAFT A
WHERE A.CRUISINGRANGE>1000 AND C.AID=A.AID AND C.EID=E.EID
GROUP BY A.ANAME;

SELECT DISTINCT E.ENAME
FROM EMPLOYEES E,AIRCRAFT A,CERTIFIED C
WHERE E.EID=C.EID AND A.AID=C.AID AND A.ANAME="Boeing";

SELECT A.AID 
FROM AIRCRAFT A
WHERE A.CRUISINGRANGE>(SELECT MIN(DISTANCE) FROM FLIGHTS F WHERE 
F.FFROM="Bangalore" AND F.TTO="Frankfurt");

select f.FFROM,f.TTO,f.ARRIVES from FlIGHTS f
where (f.FFROM = "Bangalore" and f.TTO = (select FFROM from Flights where TTO = "Kolkata")) or f.TTO = "Kolkata";
